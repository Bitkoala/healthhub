import{d as E,C as q,z as L,r as i,w as M,a as m,b as e,t as l,p as o,q as p,e as y,i as _,h as b,v as w,D as B,j as k,k as v}from"./index-DYJKNeU4.js";const D={class:"min-h-screen pt-32 pb-48 px-4 sm:px-6 lg:px-8"},F={class:"max-w-3xl mx-auto space-y-8"},T={class:"animate-fade-in text-center space-y-4 mb-12"},$={class:"inline-block relative"},j={class:"relative text-4xl font-black text-on-surface tracking-tighter sm:text-5xl"},z={class:"text-on-surface-variant font-medium tracking-wide uppercase text-xs opacity-60"},H={class:"glass-card overflow-hidden animate-slide-up",style:{"animation-delay":"0.1s"}},N={class:"p-8 space-y-10"},R={class:"space-y-6"},W={class:"flex items-center justify-between p-6 rounded-2xl bg-white/5 border border-white/10 backdrop-blur-sm transition-all hover:bg-white/10"},A=["aria-checked"],G={class:"space-y-6"},I={class:"space-y-2"},J={class:"relative group"},K={class:"space-y-2"},O={class:"relative group"},Q={class:"md:col-span-2 pt-4"},X=["disabled"],Y={class:"space-y-6"},Z={class:"flex items-center space-x-3"},ee={class:"text-sm font-bold uppercase tracking-widest text-on-surface/80"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},te={key:0,class:"space-y-2"},ae=["disabled"],oe={class:"pt-8 flex flex-col items-center border-t border-white/10 px-4"},le={class:"text-sm uppercase tracking-[0.2em]"},ie=E({__name:"ProfileView",setup(re){const t=q(),P=B(),r=L({username:t.user?.username||"",email:t.user?.email||""}),f=i(!1),u=i(""),g=i(!1),d=i({oldPassword:"",newPassword:""}),x=i(!1),c=i(""),h=i(!1);M(()=>t.user,a=>{a&&(r.username=a.username||"",r.email=a.email||"")},{immediate:!0});const S=async()=>{f.value=!0,u.value="",g.value=!1;try{const a=await k("/auth/me","PUT",r);t.setUser(a),u.value="个人资料更新成功！"}catch(a){g.value=!0,a instanceof Error?u.value=`更新失败: ${a.message}`:u.value="更新时发生未知错误"}finally{f.value=!1}},U=async()=>{x.value=!0,c.value="",h.value=!1;try{await k("/auth/me/password","PUT",d.value),c.value="密码更新成功！",d.value={oldPassword:"",newPassword:""}}catch(a){h.value=!0,a instanceof Error?c.value=`密码修改失败: ${a.message}`:c.value="修改密码时发生未知错误"}finally{x.value=!1}},V=()=>{t.logout(),P.push({name:"Login"})},C=async()=>{if(t.user)try{const a=!!t.user.show_womens_health;await t.updateShowWomensHealth(!a)}catch(a){console.error("Failed to update setting:",a)}};return(a,s)=>(v(),m("div",D,[e("div",F,[e("div",T,[e("div",$,[s[4]||(s[4]=e("div",{class:"absolute -inset-4 bg-gradient-to-r from-blue-500/20 to-purple-500/20 blur-2xl rounded-full opacity-50"},null,-1)),e("h1",j,l(o(t).user?.username),1)]),e("p",z,l(o(t).user?.email),1)]),e("div",H,[e("div",N,[e("section",R,[s[6]||(s[6]=e("div",{class:"flex items-center space-x-3"},[e("i",{"data-lucide":"settings",class:"w-5 h-5 text-blue-500/60"}),e("h3",{class:"text-sm font-bold uppercase tracking-widest text-on-surface/80"},"应用偏好")],-1)),e("div",W,[s[5]||(s[5]=e("div",{class:"space-y-1"},[e("span",{class:"text-sm font-bold text-on-surface"},"显示女性健康模块"),e("p",{class:"text-[10px] text-on-surface-variant/60 uppercase tracking-wider"},"控制侧边栏和主页是否显示经期与健康追踪")],-1)),e("button",{onClick:C,role:"switch","aria-checked":o(t).user?.show_womens_health,class:p(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none",o(t).user?.show_womens_health?"bg-blue-600":"bg-white/10"])},[e("span",{"aria-hidden":"true",class:p(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow-lg ring-0 transition duration-300 ease-in-out",o(t).user?.show_womens_health?"translate-x-5":"translate-x-0"])},null,2)],10,A)])]),s[16]||(s[16]=e("div",{class:"h-px w-full bg-gradient-to-r from-transparent via-white/10 to-transparent"},null,-1)),e("section",G,[s[11]||(s[11]=e("div",{class:"flex items-center space-x-3"},[e("i",{"data-lucide":"user",class:"w-5 h-5 text-blue-500/60"}),e("h3",{class:"text-sm font-bold uppercase tracking-widest text-on-surface/80"},"账号资料")],-1)),e("form",{onSubmit:_(S,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",I,[s[8]||(s[8]=e("label",{for:"username",class:"text-[10px] font-bold uppercase tracking-widest text-on-surface-variant/60 ml-1"},"用户名",-1)),e("div",J,[s[7]||(s[7]=e("i",{"data-lucide":"at-sign",class:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-on-surface-variant/40 group-focus-within:text-blue-500 transition-colors"},null,-1)),b(e("input",{type:"text",id:"username","onUpdate:modelValue":s[0]||(s[0]=n=>r.username=n),class:"w-full bg-white/5 border border-white/10 rounded-2xl py-3 pl-12 pr-4 text-sm text-on-surface placeholder:text-on-surface-variant/20 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/40 transition-all"},null,512),[[w,r.username]])])]),e("div",K,[s[10]||(s[10]=e("label",{for:"email",class:"text-[10px] font-bold uppercase tracking-widest text-on-surface-variant/60 ml-1"},"电子邮箱",-1)),e("div",O,[s[9]||(s[9]=e("i",{"data-lucide":"mail",class:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-on-surface-variant/40 group-focus-within:text-blue-500 transition-colors"},null,-1)),b(e("input",{type:"email",id:"email","onUpdate:modelValue":s[1]||(s[1]=n=>r.email=n),class:"w-full bg-white/5 border border-white/10 rounded-2xl py-3 pl-12 pr-4 text-sm text-on-surface placeholder:text-on-surface-variant/20 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/40 transition-all"},null,512),[[w,r.email]])])]),e("div",Q,[e("button",{type:"submit",disabled:f.value,class:"w-full py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold rounded-2xl shadow-xl shadow-blue-500/20 hover:shadow-blue-500/40 active:scale-[0.98] transition-all disabled:opacity-50 disabled:grayscale"},l(f.value?"同步中...":"提交更改"),9,X)])],32),u.value?(v(),m("p",{key:0,class:p(["text-center text-xs font-bold mt-4",g.value?"text-red-400":"text-emerald-400"])},l(u.value),3)):y("",!0)]),s[17]||(s[17]=e("div",{class:"h-px w-full bg-gradient-to-r from-transparent via-white/10 to-transparent my-10"},null,-1)),e("section",Y,[e("div",Z,[s[12]||(s[12]=e("i",{"data-lucide":"lock",class:"w-5 h-5 text-amber-500/60"},null,-1)),e("h3",ee,l(o(t).user?.has_password?"修改安全密码":"设置本地登录密码"),1)]),e("form",{onSubmit:_(U,["prevent"]),class:"space-y-6"},[e("div",se,[o(t).user?.has_password?(v(),m("div",te,[s[13]||(s[13]=e("label",{for:"oldPassword",class:"text-[10px] font-bold uppercase tracking-widest text-on-surface-variant/60 ml-1"},"当前密码",-1)),b(e("input",{type:"password",id:"oldPassword","onUpdate:modelValue":s[2]||(s[2]=n=>d.value.oldPassword=n),required:"",class:"w-full bg-white/5 border border-white/10 rounded-2xl py-3 px-4 text-sm text-on-surface focus:outline-none focus:ring-2 focus:ring-blue-500/20 transition-all"},null,512),[[w,d.value.oldPassword]])])):y("",!0),e("div",{class:p(["space-y-2",o(t).user?.has_password?"":"md:col-span-2"])},[s[14]||(s[14]=e("label",{for:"newPassword",class:"text-[10px] font-bold uppercase tracking-widest text-on-surface-variant/60 ml-1"},"新密码",-1)),b(e("input",{type:"password",id:"newPassword","onUpdate:modelValue":s[3]||(s[3]=n=>d.value.newPassword=n),required:"",class:"w-full bg-white/5 border border-white/10 rounded-2xl py-3 px-4 text-sm text-on-surface focus:outline-none focus:ring-2 focus:ring-blue-500/20 transition-all"},null,512),[[w,d.value.newPassword]])],2)]),e("button",{type:"submit",disabled:x.value,class:"w-full py-4 border border-blue-500/30 text-blue-500 bg-blue-500/5 hover:bg-blue-500/10 font-bold rounded-2xl transition-all active:scale-[0.98]"},l(x.value?"正在验证...":o(t).user?.has_password?"更新安全凭证":"保存本地密码"),9,ae)],32),c.value?(v(),m("p",{key:0,class:p(["text-center text-xs font-bold",h.value?"text-red-400":"text-emerald-400"])},l(c.value),3)):y("",!0)]),e("div",oe,[e("button",{onClick:V,class:"group flex items-center space-x-3 text-red-500/60 hover:text-red-500 font-bold transition-all"},[s[15]||(s[15]=e("i",{"data-lucide":"log-out",class:"w-5 h-5 group-hover:-translate-x-1 transition-transform"},null,-1)),e("span",le,l(a.$t("logout")),1)])])])])])]))}});export{ie as default};
