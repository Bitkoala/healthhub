import{d as j,u as L,r as p,c as N,o as R,a as l,b as t,i as M,h as b,v as S,x as h,e as v,q as d,F as w,g as C,t as c,j as y,n as q,k as a}from"./index-DtaqbA10.js";const z={class:"container mx-auto p-4 md:p-6 max-w-3xl"},B={class:"bg-white/80 backdrop-blur-sm p-6 rounded-xl shadow-md mb-6 border border-white/20"},I={class:"flex items-center justify-between"},O={class:"flex items-center space-x-4"},F={class:"flex items-center"},P={class:"flex items-center"},H={class:"flex items-center"},Q={class:"mb-8"},A={class:"flex items-center justify-between bg-white/80 backdrop-blur-sm p-2 rounded-xl shadow-md mb-6 border border-white/20"},G={key:0,class:"text-center py-12 bg-white/60 backdrop-blur-sm rounded-xl"},J={class:"space-y-3"},K={class:"flex items-start"},W=["checked","onChange"],X={class:"flex items-center text-xs text-gray-500 mt-1"},Y=["onClick"],Z={class:"space-y-3"},ee={key:0,class:"text-center py-8 bg-white/60 backdrop-blur-sm rounded-xl"},te={key:1,class:"text-center py-8 bg-white/60 backdrop-blur-sm rounded-xl"},se={class:"font-semibold line-through text-gray-500"},oe={key:0,class:"text-sm text-gray-600"},ae=j({__name:"MemoView",setup(re){const{showToast:n}=L(),u=p([]),r=p({task_name:"",priority:"medium"}),i=p("pending"),m=p(""),g=p([]),f=p(!1),x={high:{text:"高",color:"bg-red-500",border:"border-red-500"},medium:{text:"中",color:"bg-yellow-500",border:"border-yellow-500"},low:{text:"低",color:"bg-blue-500",border:"border-blue-500"}},_=N(()=>{let o=u.value;return i.value==="pending"&&(o=o.filter(e=>!e.is_completed)),i.value==="completed"&&(o=o.filter(e=>e.is_completed)),o}),$=async()=>{try{u.value=await y("/memos"),q(()=>{typeof lucide<"u"&&lucide.createIcons()})}catch(o){o instanceof Error&&n({message:`加载备忘录失败: ${o.message}`,type:"error"})}},k=()=>{u.value.sort((o,e)=>{const s={high:1,medium:2,low:3};return o.is_completed!==e.is_completed?(o.is_completed?1:0)-(e.is_completed?1:0):s[o.priority]-s[e.priority]})},E=async()=>{if(!r.value.task_name.trim()){n({message:"任务内容不能为空",type:"error"});return}try{const o=await y("/memos","POST",r.value);u.value.unshift(o),k(),r.value={task_name:"",priority:"medium"},n({message:"任务已添加",type:"success"})}catch(o){o instanceof Error&&n({message:`添加失败: ${o.message}`,type:"error"})}},V=async o=>{try{const e=!o.is_completed;await y(`/memos/${o.id}/status`,"PUT",{is_completed:e}),o.is_completed=e,o.completed_at=e?new Date().toISOString():null,k()}catch(e){e instanceof Error&&n({message:`更新状态失败: ${e.message}`,type:"error"})}},T=async o=>{if(confirm(`确定要删除任务 "${o.task_name}" 吗？`))try{await y(`/memos/${o.id}`,"DELETE"),u.value=u.value.filter(e=>e.id!==o.id),n({message:"任务已删除",type:"success"})}catch(e){e instanceof Error&&n({message:`删除失败: ${e.message}`,type:"error"})}},U=async()=>{if(!m.value.trim()){g.value=[];return}f.value=!0;try{const o=await y(`/memos/history/search?q=${encodeURIComponent(m.value)}`);g.value=o}catch(o){o instanceof Error&&n({message:"搜索失败: "+o.message,type:"error"})}finally{f.value=!1}};return R($),(o,e)=>(a(),l("div",z,[e[17]||(e[17]=t("header",{class:"mb-6"},[t("div",{class:"bg-white/80 backdrop-blur-sm px-6 py-4 rounded-xl shadow border border-white/20"},[t("h1",{class:"text-2xl font-bold"},"备忘录"),t("p",{class:"text-gray-500 mt-1"},"记录和管理您的待办事项")])],-1)),t("div",B,[t("form",{onSubmit:M(E,["prevent"]),class:"space-y-4"},[b(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>r.value.task_name=s),placeholder:"需要做什么？",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"},null,512),[[S,r.value.task_name]]),t("div",I,[t("div",O,[t("label",F,[b(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=s=>r.value.priority=s),value:"high",class:"mr-1 text-red-500 focus:ring-red-500"},null,512),[[h,r.value.priority]]),e[8]||(e[8]=t("span",{class:"text-red-600 font-semibold"},"高",-1))]),t("label",P,[b(t("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=s=>r.value.priority=s),value:"medium",class:"mr-1 text-yellow-500 focus:ring-yellow-500"},null,512),[[h,r.value.priority]]),e[9]||(e[9]=t("span",{class:"text-yellow-600 font-semibold"},"中",-1))]),t("label",H,[b(t("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=s=>r.value.priority=s),value:"low",class:"mr-1 text-blue-500 focus:ring-blue-500"},null,512),[[h,r.value.priority]]),e[10]||(e[10]=t("span",{class:"text-blue-600 font-semibold"},"低",-1))])]),e[11]||(e[11]=t("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md"}," 添加任务 ",-1))])],32)]),t("main",Q,[t("div",A,[t("button",{onClick:e[4]||(e[4]=s=>i.value="pending"),class:d([{"bg-blue-500 text-white":i.value==="pending"},"flex-1 py-2 px-4 rounded-lg"])}," 待办 ",2),t("button",{onClick:e[5]||(e[5]=s=>i.value="completed"),class:d([{"bg-blue-500 text-white":i.value==="completed"},"flex-1 py-2 px-4 rounded-lg"])}," 已完成 ",2),t("button",{onClick:e[6]||(e[6]=s=>i.value="all"),class:d([{"bg-blue-500 text-white":i.value==="all"},"flex-1 py-2 px-4 rounded-lg"])}," 全部 ",2)]),_.value.length===0?(a(),l("div",G,[...e[12]||(e[12]=[t("p",null,"太棒了！当前分类下没有任务。",-1)])])):v("",!0),t("div",J,[(a(!0),l(w,null,C(_.value,s=>(a(),l("div",{key:s.id,class:d(["bg-white/80 backdrop-blur-sm p-4 rounded-lg shadow-sm flex items-start justify-between border-l-4",x[s.priority].border])},[t("div",K,[t("input",{type:"checkbox",checked:s.is_completed,onChange:D=>V(s),class:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-4 mt-1"},null,40,W),t("div",null,[t("span",{class:d({"line-through text-gray-400":s.is_completed})},c(s.task_name),3),t("div",X,[t("span",{class:d(["w-3 h-3 rounded-full mr-1",x[s.priority].color])},null,2),t("span",null,"优先级: "+c(x[s.priority].text),1),s.is_completed&&s.completed_at?(a(),l(w,{key:0},[e[13]||(e[13]=t("span",{class:"mx-2"},"|",-1)),t("span",null,"完成于: "+c(new Date(s.completed_at).toLocaleString("zh-CN")),1)],64)):v("",!0)])])]),t("button",{onClick:D=>T(s),class:"text-xs bg-red-100 text-red-600 hover:bg-red-200 rounded-full px-2 py-1 font-semibold transition-colors"}," 删除 ",8,Y)],2))),128))])]),t("div",null,[e[16]||(e[16]=t("div",{class:"bg-white/80 backdrop-blur-sm p-4 rounded-xl shadow-md mb-4 border border-white/20"},[t("h2",{class:"text-xl font-semibold"},"查询已完成的任务")],-1)),t("form",{onSubmit:M(U,["prevent"]),class:"flex items-center space-x-2 mb-4"},[b(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=s=>m.value=s),placeholder:"输入关键词搜索...",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"},null,512),[[S,m.value]]),e[14]||(e[14]=t("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md"}," 搜索 ",-1))],32),t("main",Z,[f.value?(a(),l("div",ee,[...e[15]||(e[15]=[t("p",null,"正在搜索...",-1)])])):g.value.length===0?(a(),l("div",te,[t("p",null,c(m.value?"没有找到匹配的已完成记录":"输入关键词以查询历史"),1)])):v("",!0),(a(!0),l(w,null,C(g.value,s=>(a(),l("div",{key:s.id,class:d(["bg-white/80 backdrop-blur-sm p-4 rounded-lg shadow-sm border-l-4",x[s.priority].border])},[t("p",se,c(s.task_name),1),s.completed_at?(a(),l("p",oe," 完成于: "+c(new Date(s.completed_at).toLocaleString("zh-CN")),1)):v("",!0)],2))),128))])])]))}});export{ae as default};
